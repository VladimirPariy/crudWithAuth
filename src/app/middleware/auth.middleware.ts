import jwt from "jsonwebtoken";import {Response, Request, NextFunction} from "express";import {secret} from '../secret'export const authorizationCheck = (req: Request, res: Response, next: NextFunction) => {	if (req.method === 'OPTIONS') {		next()	}		try {		if (!req.headers.authorization) {			return res.status(400).json({message: 'User aren`t authorized'})		}		const token = req.headers.authorization.split(' ')[1];		if (!token) {			return res.status(400).json({message: 'User aren`t authorized'})		}		jwt.verify(token, secret)		next()	} catch (e) {		if (e instanceof Error) return res.status(500).json({message: e.message})		else return res.status(500).json(e)	}}